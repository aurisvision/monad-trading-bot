groups:
  - name: area51-bot-alerts
    rules:
      # High memory usage alert
      - alert: HighMemoryUsage
        expr: memory_usage_bytes{type="heapUsed"} / memory_usage_bytes{type="heapTotal"} > 0.9
        for: 2m
        labels:
          severity: critical
          service: area51-bot
        annotations:
          summary: "High memory usage detected"
          description: "Memory usage is above 90% for more than 2 minutes"

      # High error rate alert
      - alert: HighErrorRate
        expr: rate(errors_total[5m]) > 0.1
        for: 1m
        labels:
          severity: warning
          service: area51-bot
        annotations:
          summary: "High error rate detected"
          description: "Error rate is above 10% for the last 5 minutes"

      # Database connection issues
      - alert: DatabaseConnectionFailed
        expr: database_connections_active == 0
        for: 30s
        labels:
          severity: critical
          service: area51-bot
        annotations:
          summary: "Database connection failed"
          description: "No active database connections detected"

      # Redis connection issues
      - alert: RedisConnectionFailed
        expr: redis_connections_active == 0
        for: 1m
        labels:
          severity: warning
          service: area51-bot
        annotations:
          summary: "Redis connection failed"
          description: "No active Redis connections detected"

      # High API response time
      - alert: HighAPIResponseTime
        expr: histogram_quantile(0.95, rate(api_response_time_seconds_bucket[5m])) > 10
        for: 2m
        labels:
          severity: warning
          service: area51-bot
        annotations:
          summary: "High API response time"
          description: "95th percentile API response time is above 10 seconds"

      # Trading operation failures
      - alert: TradingOperationFailures
        expr: rate(trading_operations_total{status="error"}[5m]) > 0.05
        for: 2m
        labels:
          severity: warning
          service: area51-bot
        annotations:
          summary: "High trading operation failure rate"
          description: "Trading operation failure rate is above 5% for the last 5 minutes"

      # Bot instance down
      - alert: BotInstanceDown
        expr: up{job="area51-bot"} == 0
        for: 30s
        labels:
          severity: critical
          service: area51-bot
        annotations:
          summary: "Bot instance is down"
          description: "Area51 bot instance is not responding to health checks"

      # Low cache hit ratio
      - alert: LowCacheHitRatio
        expr: redis_cache_hit_ratio < 0.7
        for: 5m
        labels:
          severity: warning
          service: area51-bot
        annotations:
          summary: "Low cache hit ratio"
          description: "Redis cache hit ratio is below 70% for the last 5 minutes"

      # High CPU usage
      - alert: HighCPUUsage
        expr: cpu_usage_percent > 80
        for: 5m
        labels:
          severity: warning
          service: area51-bot
        annotations:
          summary: "High CPU usage"
          description: "CPU usage is above 80% for more than 5 minutes"

      # Database query slow
      - alert: SlowDatabaseQueries
        expr: histogram_quantile(0.95, rate(database_query_duration_seconds_bucket[5m])) > 1
        for: 3m
        labels:
          severity: warning
          service: area51-bot
        annotations:
          summary: "Slow database queries detected"
          description: "95th percentile database query time is above 1 second"
